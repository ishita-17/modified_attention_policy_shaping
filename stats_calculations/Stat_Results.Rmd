---
title: "Statistical Results from Modified Policy Shaping Experiments"
author: "Ishita Sarraf"
date: "2024-07-10"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading libraries and reading files

```{r}
library(dplyr)
library(ggplot2)
```

```{r}
d1 <- read.csv("AMPS_results.csv")
d2 <- read.csv("Best_Actions_Results.csv")
d3 <- read.csv("Similarity_Results.csv")
d <- read.csv("experiment_results.csv")
```

## Cleaning Data

```{r}
new1 <- d1 %>%
  group_by(Episode) %>%
  summarize(reward_per_episode = mean(Reward))
```

```{r}
new2 <- d2 %>%
  group_by(Episode) %>%
  summarize(reward_per_episode = mean(Reward))
```

```{r}
new3 <- d3 %>%
  group_by(Episode) %>%
  summarize(reward_per_episode = mean(Reward))
```

```{r}
avg_reward <- d %>%
  group_by(Experiment_Name, Episode) %>%
  summarise(avg_reward = mean(Reward))
```

## Creating Comparison Graph

```{r}
ggplot(d, aes(x = Episode, y = Reward, color = Experiment_Name)) +
  geom_rect(aes(xmin = 1, xmax = 5, ymin = -Inf, ymax = Inf), fill = "grey", color = NA, alpha = 0.01) +
  geom_rect(aes(xmin = 20, xmax = 25, ymin = -Inf, ymax = Inf), fill = "grey", color = NA, alpha = 0.01) +
  geom_line()+
  labs(x = "Episode Number", y = "Total Reward",
       title = "Reward for 50 episodes averaged over 15 runs")+
  theme_linedraw()+
  guides(color = guide_legend(title = NULL))
```
## ANOVA and Tukey HSD

```{r}
anova_model <- aov(Reward ~ Experiment_Name, data = d)
anova_model
```
```{r}
hsd <- TukeyHSD(anova_model)
hsd
```
## Analysis

"Best_Action" and "AMPS" have significantly different mean rewards.
"Similarity" and "AMPS" have significantly different mean rewards.
There is no significant difference in mean reward between "Similarity" and "Best_Action".
We are 95% confident that the differences in mean rewards are accurate and not due to random chance assuming all assumptions for ANOVA are satisfied.

```{r}
plot(anova_model)
```

The data does not seem completely normal, and but the variance assumption seems satisfied. 